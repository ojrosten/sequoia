<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sequoia: /Users/oliver/sequoia/Source/sequoia/TestFramework/PerformanceTestCore.hpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Sequoia
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>Source</b></li><li class="navelem"><b>sequoia</b></li><li class="navelem"><b>TestFramework</b></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">PerformanceTestCore.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Extension of the testing framework for perfomance testing.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../d9/daf/RegularTestCore_8hpp_source.html">sequoia/TestFramework/RegularTestCore.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d02/StatisticalAlgorithms_8hpp_source.html">sequoia/Maths/Statistics/StatisticalAlgorithms.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d87/FileEditors_8hpp_source.html">sequoia/TestFramework/FileEditors.hpp</a>&quot;</code><br />
<code>#include &lt;chrono&gt;</code><br />
<code>#include &lt;random&gt;</code><br />
<code>#include &lt;future&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
</div>
<p><a href="../../d9/d44/PerformanceTestCore_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:sequoia_3A_3Atesting_3A_3Aperformance_5Fextender_3C_20Mode_20_3E" id="r_sequoia_3A_3Atesting_3A_3Aperformance_5Fextender_3C_20Mode_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d92/classsequoia_1_1testing_1_1performance__extender.html">sequoia::testing::performance_extender&lt; Mode &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">class template for plugging into the checker class template <a class="anchor" id="performance_extender_primary"></a> <a href="../../d6/d92/classsequoia_1_1testing_1_1performance__extender.html#details">More...</a><br /></td></tr>
<tr class="memitem:sequoia_3A_3Atesting_3A_3Abasic_5Fperformance_5Ftest_3C_20Mode_20_3E" id="r_sequoia_3A_3Atesting_3A_3Abasic_5Fperformance_5Ftest_3C_20Mode_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d88/classsequoia_1_1testing_1_1basic__performance__test.html">sequoia::testing::basic_performance_test&lt; Mode &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">class template from which all concrete tests should derive  <a href="../../db/d88/classsequoia_1_1testing_1_1basic__performance__test.html#details">More...</a><br /></td></tr>
<tr class="memitem:sequoia_3A_3Atesting_3A_3Ais_5Fparallelizable_3C_20T_20_3E" id="r_sequoia_3A_3Atesting_3A_3Ais_5Fparallelizable_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d46/structsequoia_1_1testing_1_1is__parallelizable_3_01T_01_4.html">sequoia::testing::is_parallelizable&lt; T &gt;</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a4f488e32df14d26810296fd38f157107" id="r_a4f488e32df14d26810296fd38f157107"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f488e32df14d26810296fd38f157107">sequoia::testing::performance_test</a> = <a class="el" href="../../db/d88/classsequoia_1_1testing_1_1basic__performance__test.html">basic_performance_test</a>&lt;test_mode::standard&gt;</td></tr>
<tr class="memitem:ac5e1ccb5f467d2dca49269c9ebf823ac" id="r_ac5e1ccb5f467d2dca49269c9ebf823ac"><td class="memItemLeft" align="right" valign="top"><a id="ac5e1ccb5f467d2dca49269c9ebf823ac" name="ac5e1ccb5f467d2dca49269c9ebf823ac"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>sequoia::testing::performance_false_positive_test</b> = <a class="el" href="../../db/d88/classsequoia_1_1testing_1_1basic__performance__test.html">basic_performance_test</a>&lt;test_mode::false_positive&gt;</td></tr>
<tr class="memitem:ab13c3e619b9343101211d3827703dc4d" id="r_ab13c3e619b9343101211d3827703dc4d"><td class="memItemLeft" align="right" valign="top"><a id="ab13c3e619b9343101211d3827703dc4d" name="ab13c3e619b9343101211d3827703dc4d"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>sequoia::testing::performance_false_negative_test</b> = <a class="el" href="../../db/d88/classsequoia_1_1testing_1_1basic__performance__test.html">basic_performance_test</a>&lt;test_mode::false_negative&gt;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac977dafe31c6ddeeecedb364d5d93564" id="r_ac977dafe31c6ddeeecedb364d5d93564"><td class="memTemplParams" colspan="2"><a id="ac977dafe31c6ddeeecedb364d5d93564" name="ac977dafe31c6ddeeecedb364d5d93564"></a>
template&lt;std::invocable Task&gt; </td></tr>
<tr class="memitem:ac977dafe31c6ddeeecedb364d5d93564 template"><td class="memItemLeft" align="right" valign="top">std::chrono::duration&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sequoia::testing::profile</b> (Task task)</td></tr>
<tr class="memitem:a851cce1136b7e58818d1ba2b02ddbc6a" id="r_a851cce1136b7e58818d1ba2b02ddbc6a"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../da/d95/TestMode_8hpp.html#ae4e97c9d45a89647799f0d308ba6d244">test_mode</a> Mode, std::invocable F, std::invocable S&gt; </td></tr>
<tr class="memitem:a851cce1136b7e58818d1ba2b02ddbc6a template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a851cce1136b7e58818d1ba2b02ddbc6a">sequoia::testing::check_relative_performance</a> (std::string_view description, <a class="el" href="../../df/d20/classsequoia_1_1testing_1_1test__logger.html">test_logger</a>&lt; Mode &gt; &amp;logger, F fast, S slow, const double minSpeedUp, const double maxSpeedUp, const std::size_t trials, const double num_sds, const std::size_t maxAttempts)</td></tr>
<tr class="memdesc:a851cce1136b7e58818d1ba2b02ddbc6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for comparing the performance of a fast task to a slow task.  <br /></td></tr>
<tr class="memitem:a8274dc17241f054bcf467c61609066e4" id="r_a8274dc17241f054bcf467c61609066e4"><td class="memTemplParams" colspan="2"><a id="a8274dc17241f054bcf467c61609066e4" name="a8274dc17241f054bcf467c61609066e4"></a>
template&lt;class T, class Period&gt; </td></tr>
<tr class="memitem:a8274dc17241f054bcf467c61609066e4 template"><td class="memItemLeft" align="right" valign="top">std::chrono::duration&lt; T, Period &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sequoia::testing::calibrate</b> (std::chrono::duration&lt; T, Period &gt; target)</td></tr>
<tr class="memitem:a7c427026f953aaae88fd1d432200111c" id="r_a7c427026f953aaae88fd1d432200111c"><td class="memItemLeft" align="right" valign="top"><a id="a7c427026f953aaae88fd1d432200111c" name="a7c427026f953aaae88fd1d432200111c"></a>
std::string_view&#160;</td><td class="memItemRight" valign="bottom"><b>sequoia::testing::postprocess</b> (std::string_view testOutput, std::string_view referenceOutput)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Extension of the testing framework for perfomance testing. </p>
</div><a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="a4f488e32df14d26810296fd38f157107" name="a4f488e32df14d26810296fd38f157107"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f488e32df14d26810296fd38f157107">&#9670;&#160;</a></span>performance_test</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#a4f488e32df14d26810296fd38f157107">sequoia::testing::performance_test</a> = basic_performance_test&lt;test_mode::standard&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="anchor" id="performance_test_alias"></a> </p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a851cce1136b7e58818d1ba2b02ddbc6a" name="a851cce1136b7e58818d1ba2b02ddbc6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a851cce1136b7e58818d1ba2b02ddbc6a">&#9670;&#160;</a></span>check_relative_performance()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;test_mode Mode, std::invocable F, std::invocable S&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool sequoia::testing::check_relative_performance </td>
          <td>(</td>
          <td class="paramtype">std::string_view</td>          <td class="paramname"><span class="paramname"><em>description</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d20/classsequoia_1_1testing_1_1test__logger.html">test_logger</a>&lt; Mode &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>logger</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">F</td>          <td class="paramname"><span class="paramname"><em>fast</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">S</td>          <td class="paramname"><span class="paramname"><em>slow</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>minSpeedUp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>maxSpeedUp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t</td>          <td class="paramname"><span class="paramname"><em>trials</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>num_sds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t</td>          <td class="paramname"><span class="paramname"><em>maxAttempts</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for comparing the performance of a fast task to a slow task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">minSpeedUp</td><td>the minimum predicted speed up of fast over slow; must be &gt; 1 </td></tr>
    <tr><td class="paramname">maxSpeedUp</td><td>the maximum predicted speed up of fast over slow; must be &gt; minSpeedUp </td></tr>
    <tr><td class="paramname">trials</td><td>the number of trial used for the statistical analysis </td></tr>
    <tr><td class="paramname">num_sds</td><td>the number of standard deviations used to define a significant result </td></tr>
    <tr><td class="paramname">maxAttempts</td><td>the number of times the entire test should be re-run before accepting failure</td></tr>
  </table>
  </dd>
</dl>
<p>For each trial, both the supposedly fast and slow tasks are run. Their order is random. When all trials have been completed, the mean and standard deviations are computed for both fast and slow tasks. Denote these by m_f, sig_f and m_s, sig_s.</p>
<p>if (m_f + sig_f &lt; m_s + sig_s)</p>
<p>then it is concluded that the purportedly fast task is actually slower than the slow task and so the test fails. If this is not the case then the analysis branches depending on which standard deviation is bigger.</p>
<p>if (sig_f &gt;= sig_s)</p>
<p>then we mutliply m_f by both the min/max predicted speed-up and compare to the range of values around m_s defined by the number of standard deviations. In particular, the test is taken to pass if</p>
<p>(minSpeedUp * m_f &lt;= (m_s + num_sds * sig_s)) &amp;&amp; (maxSpeedUp * m_f &gt;= (m_s - num_sds * sig_s))</p>
<p>which is essentially saying that the range of predicted speed-ups must fall within the specified number of standard deviations of m_s.</p>
<p>On the other hand</p>
<p>if(sig_s &gt; sif_g)</p>
<p>then we divide m_s by both the min/max predicted speed-up and compare to the range of values around m_f defined by the number of standard deviations. In particular, the test is taken to pass if</p>
<p>(m_s / maxSpeedUp &lt;= (m_f + num_sds * sig_f)) &amp;&amp; (m_s / minSpeedUp &gt;= (m_f - num_sds * sig_f)) </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
